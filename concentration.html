<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Project 1: Concentration risk</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="site_libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-binding-2.0.1/leaflet.js"></script>
<link href="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet" />
<script src="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>
<link href="site_libs/ionicons-2.0.1/ionicons.min.css" rel="stylesheet" />
<meta name="description" content="Turn your analyses into high quality documents, reports, presentations and dashboards with R Markdown. Use a productive notebook interface to weave together narrative text and code to produce elegantly formatted output. Use multiple languages including R, Python, and SQL. R Markdown supports a reproducible workflow for dozens of static and dynamic output formats including HTML, PDF, MS Word, Beamer, HTML5 slides, Tufte-style handouts, books, dashboards, shiny applications, scientific articles, websites, and more." />

<link rel="icon" type="image/png" href="images/favicon.png" />

<script type="text/javascript" src="js/rmarkdown.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-20375833-14', 'auto');
  ga('send', 'pageview');
</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css/rmarkdown.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<div id="rStudioHeader" class="alwaysShrunk">
  <div class="innards bandContent">
    <div>
    <a class="productName" href="index.html"> Martin Haringa </a>
      <div class="rStudio"><span class="light"> </span> 
      <a href="https://www.rstudio.com/"><div class="logo"></div></a></div>
        </div>
        
        <div id="menu">
          <div id="menuToggler"></div>
            <div id="menuItems">
              <a class="menuItem" href="index.html">Home</a>
                <a class="menuItem" href="concentration.html">Project 1: Concentration risk</a>
                  <a class="menuItem" href="thesis.html">Project 2: Master's thesis</a>
                  <a class="menuItem" href="blog1.html">Blog</a>
                  <a class="menuItem" href="aboutme.html">About me</a>
                    <a class="menuItem" href="contact.html">Contact me</a>
                      <a class="menuItem gitHub" href="https://github.com/mharinga"></a>
                        <a class="menuItem gitHubText" href="https://github.com/mharinga">Source on GitHub</a>
                          </div>
                          </div>
                          </div>
                          </div>
                          
                          <style type="text/css">
                            #TOC {
                            margin-left: 35px;
                          margin-top: 90px;
                          }
</style>
  
  <script type="text/javascript">
    $(".main-container").removeClass("main-container").removeClass("container-fluid").addClass("footerPushDown");
  </script>
    
    
    <div id="pageContent" class="standardPadding">
      <div class="articleBandContent">

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Project 1: Concentration risk</h1>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The goal of this project is to determine the coördinates (long/lat) in the Netherlands with the highest concentration risks. Concentration risk is defined as the cumulation of all exposures within a certain radius. And it is used today by regulators who, working in the context of Solvency II, for example, ask insurance companies to report their maximum exposure within a 200-meter radius.</p>
<p>The calculations given below are summarized in the R-package spatialrisk. spatialrisk is an R-package for spatial risk calculations. In particular, it can be used to determine concentration risk. The package is currently work-in-progress and contributions are welcome.</p>
<p>The quickest way to get the development version of the package running locally is using devtools:</p>
<pre class="r"><code>devtools::install_github(repo = &quot;MHaringa/spatialrisk&quot;)
library(spatialrisk)</code></pre>
<div id="waarom-meten-we-concentratierisico" class="section level2">
<h2>Waarom meten we concentratierisico?</h2>
<p>EIOPA schrijft voor: “Largest fire concentration in respect of the fire peril within a radius of 200m. This is the maximum gross sum insured of the set of buildings fully or partly located within this radius.” – <em>Solvency II (SF)</em></p>
<p>Achtergrond: - Bestand tegen catastrofes. - Tot halverwege 2017 het enige risico dat we niet konden meten. - Nu meten we ook concentratierisico zoals voorgeschreven.</p>
</div>
<div id="hoe-meten-we-concentratierisico" class="section level2">
<h2>Hoe meten we concentratierisico?</h2>
<p>Stappen: 1. Trek rond elk adres een cirkel met een straal van 200 meter. 2. Tel verzekerde sommen binnen elke cirkel op. 3. Orden de verkregen <strong>concentraties</strong> van groot naar klein.</p>
<p>Uitdaging: Herhaal deze stappen voor alle circa 350.000 adressen.</p>
</div>
</div>
<div id="hoe-werkt-het-algoritme" class="section level1">
<h1>Hoe werkt het algoritme?</h1>
<p>Voorbeeld: Concentratierisico voor Grote Markt 1, Groningen.</p>
<pre class="r"><code>centrum &lt;- c(6.568865, 53.21828)

set.seed(2)
df &lt;- Groningen %&gt;% 
  sample_n(2000) %&gt;%
  points_in_circle(., centrum[1], centrum[2], radius = 530)

blok &lt;- block_around_point(centrum[1], centrum[2], radius = 200)

icons_fn &lt;- function(icoon, kleur){
  awesomeIcons(
    icon = icoon,
    iconColor = &#39;black&#39;,
    library = &#39;ion&#39;,
    markerColor = kleur
    )
}</code></pre>
<pre class="r"><code>p1 &lt;- leaflet(df, width = &quot;100%&quot;) %&gt;%
  addTiles() %&gt;%  # Add default OpenStreetMap map tiles
  addAwesomeMarkers(lng = centrum[1], lat = centrum[2], icon = icons_fn(&quot;ion-ios-star&quot;, &quot;red&quot;), popup = &quot;Grote Markt 1, Groningen&quot;) 

p1</code></pre>
<div id="htmlwidget-feea1a7e93f9a9753953" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-feea1a7e93f9a9753953">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Grote Markt 1, Groningen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[53.21828,53.21828],"lng":[6.568865,6.568865]}},"evals":[],"jsHooks":[]}</script>
<p>Welke adressen liggen binnen een straal van 200 meter?</p>
<pre class="r"><code>p2 &lt;- p1 %&gt;%
  addAwesomeMarkers(lng = ~lon, lat = ~lat, icon = icons_fn(&quot;ion-ios-home-outline&quot;, &quot;orange&quot;))

p2</code></pre>
<div id="htmlwidget-d92fe3bffb2a0518b71b" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-d92fe3bffb2a0518b71b">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Grote Markt 1, Groningen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.2177373790044,53.2173285539375,53.2179300431445,53.2176394244576,53.2195572715696,53.2180119595637,53.2175184008692,53.2165996962098,53.219873415161,53.2173118987999,53.2163094013646,53.2171378942898,53.2166408418992,53.2191037678777,53.2161123576238,53.2166686130376,53.2204907305995,53.2166919572585,53.2196523878589,53.2159796911457,53.2195059973846,53.2195922682021,53.2176418791436,53.2207301840838,53.2190038710507,53.2157223578049,53.2182030663609,53.2156829310463,53.219954909918,53.2193866875824,53.2154859169103,53.2155817991444,53.2163128247022,53.2179336703458,53.2166910650464,53.2168936926272,53.2211525443666,53.2160421644618,53.2184511812159,53.215797206594,53.2183006213733,53.2167647248545,53.2164310039149,53.2153141747303,53.2153056256089,53.2157825088919,53.2213487692245,53.215557716607,53.2153634273226,53.2150670576958,53.2163038990505,53.2203039963528,53.221300950409,53.2174760909169,53.219886472525,53.2194378840393,53.2186210047531,53.2150942630355,53.2151674909867,53.2161662738447,53.2205405483542,53.2214588053398,53.2172971809997,53.2149229955026,53.2160380947013,53.2214322006943,53.2157242195534,53.2147803936376,53.2164546247836,53.2163945180733,53.2214663272668,53.2179927121175,53.2206414485976,53.2146806326981,53.2215104725557,53.2148448336952,53.2208483185609,53.22167139666,53.2155443540736,53.2176161219534,53.2164319648024,53.2204238319501,53.2215869360385,53.218526723402,53.2177978616399,53.2192111060978,53.2148649757222,53.2152999005499,53.2156357384904,53.2211696602,53.2152892775584,53.2145527039588,53.2143967503707,53.2187393824143,53.2220701365753,53.2188411298564,53.2166123156835,53.2211342582888,53.2219391989196,53.2223504595177,53.215218090883,53.2141563895887,53.2173954586479,53.2147219151774,53.2224017038569,53.2158201683047,53.2170968892164,53.2168804310761,53.2224986005841,53.2152187961767,53.2148455363806,53.2225761003961,53.2225462389901,53.2204333408742,53.2154068574911,53.2225348848186,53.2226176620847,53.2151956989775,53.2197879829053,53.2190618353494,53.2190486090455,53.2190307172422,53.2138149085314,53.2195576619144,53.2224259516829,53.2150898749316,53.2137991155113,53.2207501358322,53.219563139474,53.2137151100644,53.2138190307771,53.2149764232648,53.2180837672207,53.2229138813987,53.2178306006794,53.2229503752181,53.2229879449576,53.2149124828962,53.2171067478831,53.2170289696865,53.2170566376322],[6.56954269376849,6.56857358181483,6.56690733512168,6.56658360513712,6.5674885359709,6.57151078592449,6.566334378217,6.56927228963378,6.56744626199739,6.57145729146179,6.56874841147005,6.56600652721291,6.56672767905939,6.56563034492428,6.56791119546557,6.5714739980291,6.56959542906929,6.57154617099569,6.56581688580706,6.56912879992328,6.5722257745779,6.56554155087897,6.57291138986805,6.56761183829811,6.56469067593046,6.56786543651903,6.5644324853776,6.56779089673334,6.57234979486227,6.57303869461157,6.56806995031835,6.56722258944165,6.57238760539811,6.57368201492079,6.57295581061705,6.57322018086482,6.57009850756302,6.57215000281837,6.57387537488373,6.56602190360323,6.56382335800716,6.57322875441805,6.57296435224638,6.5674282009664,6.5673773508574,6.56577542299857,6.56777642567897,6.56613099423001,6.57106334041015,6.56903405447653,6.56456084089018,6.5731137195653,6.56684281041853,6.57416455467469,6.56409124870617,6.5740320489289,6.57439606515953,6.57052439896184,6.57100289684666,6.5644672803039,6.56461684304987,6.56671664339561,6.56329012468512,6.57045925891402,6.56437357331895,6.57141958283825,6.56482029652979,6.56978989085716,6.57393827211977,6.57390431394439,6.57151101509391,6.56285520641188,6.57343604420821,6.5696123787756,6.57162895488318,6.56690545344321,6.5644460168265,6.56640206479719,6.5646896404414,6.5749913367414,6.56340262991514,6.56366138540319,6.56577800249164,6.57519102256682,6.57515940349729,6.57507975242389,6.57178378308375,6.56482388847762,6.56417931165256,6.56458364125831,6.56478004870399,6.57067495659759,6.56853241874381,6.56233133790551,6.57065797162274,6.57552325703156,6.57504374750122,6.57372367913826,6.57187982601073,6.56986117263208,6.56426499726943,6.56887385585258,6.56213779622595,6.57237858782712,6.56799194914215,6.5632534899044,6.56214847044168,6.56226348169167,6.56921630788513,6.56400346003002,6.56474177772425,6.5693128798888,6.56721928549392,6.57531265859465,6.57448750897306,6.5709331814821,6.56727692178208,6.56348956955932,6.57588789066213,6.57621273283885,6.57625246469965,6.57625879987486,6.56997803683013,6.56162300611469,6.57188204243475,6.56348959449191,6.57000577907661,6.56249499143799,6.56154905658301,6.56835112475971,6.56705492114196,6.56354076174848,6.56116223740797,6.56898708479061,6.56108438070039,6.56938849117961,6.56916248916267,6.56334940195631,6.57650882770049,6.56124056343689,6.57651265915784],{"icon":"ion-ios-home-outline","markerColor":"orange","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[53.2137151100644,53.2229879449576],"lng":[6.56108438070039,6.57651265915784]}},"evals":[],"jsHooks":[]}</script>
<div id="aanpak-1" class="section level2">
<h2>Aanpak 1</h2>
<p>Bereken de afstand tussen de rode marker en alle andere markers. Werkt dit?</p>
<pre class="r"><code>p2</code></pre>
<div id="htmlwidget-2167cf4cb9a14bfbb326" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-2167cf4cb9a14bfbb326">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Grote Markt 1, Groningen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.2177373790044,53.2173285539375,53.2179300431445,53.2176394244576,53.2195572715696,53.2180119595637,53.2175184008692,53.2165996962098,53.219873415161,53.2173118987999,53.2163094013646,53.2171378942898,53.2166408418992,53.2191037678777,53.2161123576238,53.2166686130376,53.2204907305995,53.2166919572585,53.2196523878589,53.2159796911457,53.2195059973846,53.2195922682021,53.2176418791436,53.2207301840838,53.2190038710507,53.2157223578049,53.2182030663609,53.2156829310463,53.219954909918,53.2193866875824,53.2154859169103,53.2155817991444,53.2163128247022,53.2179336703458,53.2166910650464,53.2168936926272,53.2211525443666,53.2160421644618,53.2184511812159,53.215797206594,53.2183006213733,53.2167647248545,53.2164310039149,53.2153141747303,53.2153056256089,53.2157825088919,53.2213487692245,53.215557716607,53.2153634273226,53.2150670576958,53.2163038990505,53.2203039963528,53.221300950409,53.2174760909169,53.219886472525,53.2194378840393,53.2186210047531,53.2150942630355,53.2151674909867,53.2161662738447,53.2205405483542,53.2214588053398,53.2172971809997,53.2149229955026,53.2160380947013,53.2214322006943,53.2157242195534,53.2147803936376,53.2164546247836,53.2163945180733,53.2214663272668,53.2179927121175,53.2206414485976,53.2146806326981,53.2215104725557,53.2148448336952,53.2208483185609,53.22167139666,53.2155443540736,53.2176161219534,53.2164319648024,53.2204238319501,53.2215869360385,53.218526723402,53.2177978616399,53.2192111060978,53.2148649757222,53.2152999005499,53.2156357384904,53.2211696602,53.2152892775584,53.2145527039588,53.2143967503707,53.2187393824143,53.2220701365753,53.2188411298564,53.2166123156835,53.2211342582888,53.2219391989196,53.2223504595177,53.215218090883,53.2141563895887,53.2173954586479,53.2147219151774,53.2224017038569,53.2158201683047,53.2170968892164,53.2168804310761,53.2224986005841,53.2152187961767,53.2148455363806,53.2225761003961,53.2225462389901,53.2204333408742,53.2154068574911,53.2225348848186,53.2226176620847,53.2151956989775,53.2197879829053,53.2190618353494,53.2190486090455,53.2190307172422,53.2138149085314,53.2195576619144,53.2224259516829,53.2150898749316,53.2137991155113,53.2207501358322,53.219563139474,53.2137151100644,53.2138190307771,53.2149764232648,53.2180837672207,53.2229138813987,53.2178306006794,53.2229503752181,53.2229879449576,53.2149124828962,53.2171067478831,53.2170289696865,53.2170566376322],[6.56954269376849,6.56857358181483,6.56690733512168,6.56658360513712,6.5674885359709,6.57151078592449,6.566334378217,6.56927228963378,6.56744626199739,6.57145729146179,6.56874841147005,6.56600652721291,6.56672767905939,6.56563034492428,6.56791119546557,6.5714739980291,6.56959542906929,6.57154617099569,6.56581688580706,6.56912879992328,6.5722257745779,6.56554155087897,6.57291138986805,6.56761183829811,6.56469067593046,6.56786543651903,6.5644324853776,6.56779089673334,6.57234979486227,6.57303869461157,6.56806995031835,6.56722258944165,6.57238760539811,6.57368201492079,6.57295581061705,6.57322018086482,6.57009850756302,6.57215000281837,6.57387537488373,6.56602190360323,6.56382335800716,6.57322875441805,6.57296435224638,6.5674282009664,6.5673773508574,6.56577542299857,6.56777642567897,6.56613099423001,6.57106334041015,6.56903405447653,6.56456084089018,6.5731137195653,6.56684281041853,6.57416455467469,6.56409124870617,6.5740320489289,6.57439606515953,6.57052439896184,6.57100289684666,6.5644672803039,6.56461684304987,6.56671664339561,6.56329012468512,6.57045925891402,6.56437357331895,6.57141958283825,6.56482029652979,6.56978989085716,6.57393827211977,6.57390431394439,6.57151101509391,6.56285520641188,6.57343604420821,6.5696123787756,6.57162895488318,6.56690545344321,6.5644460168265,6.56640206479719,6.5646896404414,6.5749913367414,6.56340262991514,6.56366138540319,6.56577800249164,6.57519102256682,6.57515940349729,6.57507975242389,6.57178378308375,6.56482388847762,6.56417931165256,6.56458364125831,6.56478004870399,6.57067495659759,6.56853241874381,6.56233133790551,6.57065797162274,6.57552325703156,6.57504374750122,6.57372367913826,6.57187982601073,6.56986117263208,6.56426499726943,6.56887385585258,6.56213779622595,6.57237858782712,6.56799194914215,6.5632534899044,6.56214847044168,6.56226348169167,6.56921630788513,6.56400346003002,6.56474177772425,6.5693128798888,6.56721928549392,6.57531265859465,6.57448750897306,6.5709331814821,6.56727692178208,6.56348956955932,6.57588789066213,6.57621273283885,6.57625246469965,6.57625879987486,6.56997803683013,6.56162300611469,6.57188204243475,6.56348959449191,6.57000577907661,6.56249499143799,6.56154905658301,6.56835112475971,6.56705492114196,6.56354076174848,6.56116223740797,6.56898708479061,6.56108438070039,6.56938849117961,6.56916248916267,6.56334940195631,6.57650882770049,6.56124056343689,6.57651265915784],{"icon":"ion-ios-home-outline","markerColor":"orange","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[53.2137151100644,53.2229879449576],"lng":[6.56108438070039,6.57651265915784]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="haversine-formule" class="section level2">
<h2>Haversine formule</h2>
<p>De Haversine (‘half-versed-sine’) formule bepaalt de kortste afstand tussen twee punten op een globe.</p>
<pre class="r"><code>lat_from &lt;- 53.24007; lon_from &lt;- 6.520386; lat_to &lt;- 53.24054; lon_to &lt;- 6.520386

toRad &lt;- pi/180 # Naar radialen
lat_to &lt;- lat_to * toRad; lat_from &lt;- lat_from * toRad
lon_to &lt;- lon_to * toRad; lon_from &lt;- lon_from * toRad
dLat &lt;- (lat_to - lat_from); dLon &lt;- (lon_to - lon_from)

a &lt;- (sin(dLat/2)^2) + (cos(lat_from) * cos(lat_to)) * (sin(dLon/2)^2)
2 * atan2(sqrt(a), sqrt(1 - a)) * 6378137 # Radius globe </code></pre>
<pre><code>## [1] 52.32016</code></pre>
</div>
<div id="aanpak-2" class="section level2">
<h2>Aanpak 2</h2>
<p>Pas Haversine formule toe op een deel van de adressen. Blok om Grote Markt 1?</p>
<pre class="r"><code>lat_center &lt;- 53.24007; lon_center &lt;- 6.520386; radius &lt;- 200; omtrek_aarde &lt;- 40075000 

one_lat_in_meters &lt;- omtrek_aarde / 360
one_lon_in_meters &lt;- omtrek_aarde * cos(lat_center * pi / 180) / 360

zuid_lat &lt;- lat_center - radius / one_lat_in_meters
noord_lat &lt;- lat_center + radius / one_lat_in_meters
west_lon &lt;- lon_center - radius / one_lon_in_meters
oost_lon &lt;- lon_center + radius / one_lon_in_meters
c(zuid_lat, noord_lat, west_lon, oost_lon) </code></pre>
<pre><code>## [1] 53.238273 53.241867  6.517384  6.523388</code></pre>
<p>Blok van 400 x 400 meter om Grote Markt 1.</p>
<pre class="r"><code>p3 &lt;- p2 %&gt;%
  addAwesomeMarkers(lng = blok[4], lat = centrum[2], icon = icons_fn(&quot;ion-arrow-right-c&quot;, &quot;blue&quot;)) %&gt;%
  addAwesomeMarkers(lng = blok[3], lat = centrum[2], icon = icons_fn(&quot;ion-arrow-left-c&quot;, &quot;blue&quot;)) %&gt;%
  addAwesomeMarkers(lng = centrum[1], lat = blok[1], icon = icons_fn(&quot;ion-arrow-down-c&quot;, &quot;blue&quot;)) %&gt;%
  addAwesomeMarkers(lng = centrum[1], lat = blok[2], icon = icons_fn(&quot;ion-arrow-up-c&quot;, &quot;blue&quot;)) 

p3</code></pre>
<div id="htmlwidget-6f221874e83bdcb687e2" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6f221874e83bdcb687e2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Grote Markt 1, Groningen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.2177373790044,53.2173285539375,53.2179300431445,53.2176394244576,53.2195572715696,53.2180119595637,53.2175184008692,53.2165996962098,53.219873415161,53.2173118987999,53.2163094013646,53.2171378942898,53.2166408418992,53.2191037678777,53.2161123576238,53.2166686130376,53.2204907305995,53.2166919572585,53.2196523878589,53.2159796911457,53.2195059973846,53.2195922682021,53.2176418791436,53.2207301840838,53.2190038710507,53.2157223578049,53.2182030663609,53.2156829310463,53.219954909918,53.2193866875824,53.2154859169103,53.2155817991444,53.2163128247022,53.2179336703458,53.2166910650464,53.2168936926272,53.2211525443666,53.2160421644618,53.2184511812159,53.215797206594,53.2183006213733,53.2167647248545,53.2164310039149,53.2153141747303,53.2153056256089,53.2157825088919,53.2213487692245,53.215557716607,53.2153634273226,53.2150670576958,53.2163038990505,53.2203039963528,53.221300950409,53.2174760909169,53.219886472525,53.2194378840393,53.2186210047531,53.2150942630355,53.2151674909867,53.2161662738447,53.2205405483542,53.2214588053398,53.2172971809997,53.2149229955026,53.2160380947013,53.2214322006943,53.2157242195534,53.2147803936376,53.2164546247836,53.2163945180733,53.2214663272668,53.2179927121175,53.2206414485976,53.2146806326981,53.2215104725557,53.2148448336952,53.2208483185609,53.22167139666,53.2155443540736,53.2176161219534,53.2164319648024,53.2204238319501,53.2215869360385,53.218526723402,53.2177978616399,53.2192111060978,53.2148649757222,53.2152999005499,53.2156357384904,53.2211696602,53.2152892775584,53.2145527039588,53.2143967503707,53.2187393824143,53.2220701365753,53.2188411298564,53.2166123156835,53.2211342582888,53.2219391989196,53.2223504595177,53.215218090883,53.2141563895887,53.2173954586479,53.2147219151774,53.2224017038569,53.2158201683047,53.2170968892164,53.2168804310761,53.2224986005841,53.2152187961767,53.2148455363806,53.2225761003961,53.2225462389901,53.2204333408742,53.2154068574911,53.2225348848186,53.2226176620847,53.2151956989775,53.2197879829053,53.2190618353494,53.2190486090455,53.2190307172422,53.2138149085314,53.2195576619144,53.2224259516829,53.2150898749316,53.2137991155113,53.2207501358322,53.219563139474,53.2137151100644,53.2138190307771,53.2149764232648,53.2180837672207,53.2229138813987,53.2178306006794,53.2229503752181,53.2229879449576,53.2149124828962,53.2171067478831,53.2170289696865,53.2170566376322],[6.56954269376849,6.56857358181483,6.56690733512168,6.56658360513712,6.5674885359709,6.57151078592449,6.566334378217,6.56927228963378,6.56744626199739,6.57145729146179,6.56874841147005,6.56600652721291,6.56672767905939,6.56563034492428,6.56791119546557,6.5714739980291,6.56959542906929,6.57154617099569,6.56581688580706,6.56912879992328,6.5722257745779,6.56554155087897,6.57291138986805,6.56761183829811,6.56469067593046,6.56786543651903,6.5644324853776,6.56779089673334,6.57234979486227,6.57303869461157,6.56806995031835,6.56722258944165,6.57238760539811,6.57368201492079,6.57295581061705,6.57322018086482,6.57009850756302,6.57215000281837,6.57387537488373,6.56602190360323,6.56382335800716,6.57322875441805,6.57296435224638,6.5674282009664,6.5673773508574,6.56577542299857,6.56777642567897,6.56613099423001,6.57106334041015,6.56903405447653,6.56456084089018,6.5731137195653,6.56684281041853,6.57416455467469,6.56409124870617,6.5740320489289,6.57439606515953,6.57052439896184,6.57100289684666,6.5644672803039,6.56461684304987,6.56671664339561,6.56329012468512,6.57045925891402,6.56437357331895,6.57141958283825,6.56482029652979,6.56978989085716,6.57393827211977,6.57390431394439,6.57151101509391,6.56285520641188,6.57343604420821,6.5696123787756,6.57162895488318,6.56690545344321,6.5644460168265,6.56640206479719,6.5646896404414,6.5749913367414,6.56340262991514,6.56366138540319,6.56577800249164,6.57519102256682,6.57515940349729,6.57507975242389,6.57178378308375,6.56482388847762,6.56417931165256,6.56458364125831,6.56478004870399,6.57067495659759,6.56853241874381,6.56233133790551,6.57065797162274,6.57552325703156,6.57504374750122,6.57372367913826,6.57187982601073,6.56986117263208,6.56426499726943,6.56887385585258,6.56213779622595,6.57237858782712,6.56799194914215,6.5632534899044,6.56214847044168,6.56226348169167,6.56921630788513,6.56400346003002,6.56474177772425,6.5693128798888,6.56721928549392,6.57531265859465,6.57448750897306,6.5709331814821,6.56727692178208,6.56348956955932,6.57588789066213,6.57621273283885,6.57625246469965,6.57625879987486,6.56997803683013,6.56162300611469,6.57188204243475,6.56348959449191,6.57000577907661,6.56249499143799,6.56154905658301,6.56835112475971,6.56705492114196,6.56354076174848,6.56116223740797,6.56898708479061,6.56108438070039,6.56938849117961,6.56916248916267,6.56334940195631,6.57650882770049,6.56124056343689,6.57651265915784],{"icon":"ion-ios-home-outline","markerColor":"orange","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[53.21828,6.57186554615979,{"icon":"ion-arrow-right-c","markerColor":"blue","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[53.21828,6.56586445384021,{"icon":"ion-arrow-left-c","markerColor":"blue","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[53.2164833686837,6.568865,{"icon":"ion-arrow-down-c","markerColor":"blue","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[53.2200766313163,6.568865,{"icon":"ion-arrow-up-c","markerColor":"blue","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[53.2137151100644,53.2229879449576],"lng":[6.56108438070039,6.57651265915784]}},"evals":[],"jsHooks":[]}</script>
<p>Blok van 400 x 400 meter om Grote Markt 1.</p>
<pre class="r"><code>p4 &lt;- p3 %&gt;%
  addRectangles(
    lng1=blok[3], lat1=blok[1],
    lng2=blok[4], lat2=blok[2],
    fillColor = &quot;transparent&quot;
  )

p4</code></pre>
<div id="htmlwidget-55277923f7fd2e4981c8" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-55277923f7fd2e4981c8">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Grote Markt 1, Groningen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.2177373790044,53.2173285539375,53.2179300431445,53.2176394244576,53.2195572715696,53.2180119595637,53.2175184008692,53.2165996962098,53.219873415161,53.2173118987999,53.2163094013646,53.2171378942898,53.2166408418992,53.2191037678777,53.2161123576238,53.2166686130376,53.2204907305995,53.2166919572585,53.2196523878589,53.2159796911457,53.2195059973846,53.2195922682021,53.2176418791436,53.2207301840838,53.2190038710507,53.2157223578049,53.2182030663609,53.2156829310463,53.219954909918,53.2193866875824,53.2154859169103,53.2155817991444,53.2163128247022,53.2179336703458,53.2166910650464,53.2168936926272,53.2211525443666,53.2160421644618,53.2184511812159,53.215797206594,53.2183006213733,53.2167647248545,53.2164310039149,53.2153141747303,53.2153056256089,53.2157825088919,53.2213487692245,53.215557716607,53.2153634273226,53.2150670576958,53.2163038990505,53.2203039963528,53.221300950409,53.2174760909169,53.219886472525,53.2194378840393,53.2186210047531,53.2150942630355,53.2151674909867,53.2161662738447,53.2205405483542,53.2214588053398,53.2172971809997,53.2149229955026,53.2160380947013,53.2214322006943,53.2157242195534,53.2147803936376,53.2164546247836,53.2163945180733,53.2214663272668,53.2179927121175,53.2206414485976,53.2146806326981,53.2215104725557,53.2148448336952,53.2208483185609,53.22167139666,53.2155443540736,53.2176161219534,53.2164319648024,53.2204238319501,53.2215869360385,53.218526723402,53.2177978616399,53.2192111060978,53.2148649757222,53.2152999005499,53.2156357384904,53.2211696602,53.2152892775584,53.2145527039588,53.2143967503707,53.2187393824143,53.2220701365753,53.2188411298564,53.2166123156835,53.2211342582888,53.2219391989196,53.2223504595177,53.215218090883,53.2141563895887,53.2173954586479,53.2147219151774,53.2224017038569,53.2158201683047,53.2170968892164,53.2168804310761,53.2224986005841,53.2152187961767,53.2148455363806,53.2225761003961,53.2225462389901,53.2204333408742,53.2154068574911,53.2225348848186,53.2226176620847,53.2151956989775,53.2197879829053,53.2190618353494,53.2190486090455,53.2190307172422,53.2138149085314,53.2195576619144,53.2224259516829,53.2150898749316,53.2137991155113,53.2207501358322,53.219563139474,53.2137151100644,53.2138190307771,53.2149764232648,53.2180837672207,53.2229138813987,53.2178306006794,53.2229503752181,53.2229879449576,53.2149124828962,53.2171067478831,53.2170289696865,53.2170566376322],[6.56954269376849,6.56857358181483,6.56690733512168,6.56658360513712,6.5674885359709,6.57151078592449,6.566334378217,6.56927228963378,6.56744626199739,6.57145729146179,6.56874841147005,6.56600652721291,6.56672767905939,6.56563034492428,6.56791119546557,6.5714739980291,6.56959542906929,6.57154617099569,6.56581688580706,6.56912879992328,6.5722257745779,6.56554155087897,6.57291138986805,6.56761183829811,6.56469067593046,6.56786543651903,6.5644324853776,6.56779089673334,6.57234979486227,6.57303869461157,6.56806995031835,6.56722258944165,6.57238760539811,6.57368201492079,6.57295581061705,6.57322018086482,6.57009850756302,6.57215000281837,6.57387537488373,6.56602190360323,6.56382335800716,6.57322875441805,6.57296435224638,6.5674282009664,6.5673773508574,6.56577542299857,6.56777642567897,6.56613099423001,6.57106334041015,6.56903405447653,6.56456084089018,6.5731137195653,6.56684281041853,6.57416455467469,6.56409124870617,6.5740320489289,6.57439606515953,6.57052439896184,6.57100289684666,6.5644672803039,6.56461684304987,6.56671664339561,6.56329012468512,6.57045925891402,6.56437357331895,6.57141958283825,6.56482029652979,6.56978989085716,6.57393827211977,6.57390431394439,6.57151101509391,6.56285520641188,6.57343604420821,6.5696123787756,6.57162895488318,6.56690545344321,6.5644460168265,6.56640206479719,6.5646896404414,6.5749913367414,6.56340262991514,6.56366138540319,6.56577800249164,6.57519102256682,6.57515940349729,6.57507975242389,6.57178378308375,6.56482388847762,6.56417931165256,6.56458364125831,6.56478004870399,6.57067495659759,6.56853241874381,6.56233133790551,6.57065797162274,6.57552325703156,6.57504374750122,6.57372367913826,6.57187982601073,6.56986117263208,6.56426499726943,6.56887385585258,6.56213779622595,6.57237858782712,6.56799194914215,6.5632534899044,6.56214847044168,6.56226348169167,6.56921630788513,6.56400346003002,6.56474177772425,6.5693128798888,6.56721928549392,6.57531265859465,6.57448750897306,6.5709331814821,6.56727692178208,6.56348956955932,6.57588789066213,6.57621273283885,6.57625246469965,6.57625879987486,6.56997803683013,6.56162300611469,6.57188204243475,6.56348959449191,6.57000577907661,6.56249499143799,6.56154905658301,6.56835112475971,6.56705492114196,6.56354076174848,6.56116223740797,6.56898708479061,6.56108438070039,6.56938849117961,6.56916248916267,6.56334940195631,6.57650882770049,6.56124056343689,6.57651265915784],{"icon":"ion-ios-home-outline","markerColor":"orange","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[53.21828,6.57186554615979,{"icon":"ion-arrow-right-c","markerColor":"blue","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[53.21828,6.56586445384021,{"icon":"ion-arrow-left-c","markerColor":"blue","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[53.2164833686837,6.568865,{"icon":"ion-arrow-down-c","markerColor":"blue","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[53.2200766313163,6.568865,{"icon":"ion-arrow-up-c","markerColor":"blue","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRectangles","args":[53.2164833686837,6.56586445384021,53.2200766313163,6.57186554615979,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"transparent","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[53.2137151100644,53.2229879449576],"lng":[6.56108438070039,6.57651265915784]}},"evals":[],"jsHooks":[]}</script>
<p>Pas Haversine formule alleen toe op adressen in het blok.</p>
<pre class="r"><code>data_binnen_blok &lt;- df[df$lon &gt; blok[3] &amp;
                       df$lon &lt; blok[4] &amp;
                       df$lat &gt; blok[1] &amp;
                       df$lat &lt; blok[2], ]

data_buiten_blok &lt;- setdiff(df, data_binnen_blok)

p4 &lt;- p1 %&gt;%
  addRectangles(
    lng1 = blok[3], lat1 = blok[1],
    lng2 = blok[4], lat2 = blok[2],
    fillColor = &quot;transparent&quot;
  ) %&gt;%
  addAwesomeMarkers(data = data_buiten_blok, ~lon, ~lat,  icon = icons_fn(&quot;ion-ios-home-outline&quot;, &quot;lightgray&quot;)) %&gt;%
  addAwesomeMarkers(data = data_binnen_blok, ~lon, ~lat,  icon = icons_fn(&quot;ion-ios-home-outline&quot;, &quot;orange&quot;))

p4</code></pre>
<div id="htmlwidget-a79dc874a6d44e64ff00" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-a79dc874a6d44e64ff00">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Grote Markt 1, Groningen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRectangles","args":[53.2164833686837,6.56586445384021,53.2200766313163,6.57186554615979,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"transparent","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.2163094013646,53.2191037678777,53.2161123576238,53.2204907305995,53.2196523878589,53.2159796911457,53.2195059973846,53.2195922682021,53.2176418791436,53.2207301840838,53.2190038710507,53.2157223578049,53.2182030663609,53.2156829310463,53.219954909918,53.2193866875824,53.2154859169103,53.2155817991444,53.2163128247022,53.2179336703458,53.2166910650464,53.2168936926272,53.2211525443666,53.2160421644618,53.2184511812159,53.215797206594,53.2183006213733,53.2167647248545,53.2164310039149,53.2153141747303,53.2153056256089,53.2157825088919,53.2213487692245,53.215557716607,53.2153634273226,53.2150670576958,53.2163038990505,53.2203039963528,53.221300950409,53.2174760909169,53.219886472525,53.2194378840393,53.2186210047531,53.2150942630355,53.2151674909867,53.2161662738447,53.2205405483542,53.2214588053398,53.2172971809997,53.2149229955026,53.2160380947013,53.2214322006943,53.2157242195534,53.2147803936376,53.2164546247836,53.2163945180733,53.2214663272668,53.2179927121175,53.2206414485976,53.2146806326981,53.2215104725557,53.2148448336952,53.2208483185609,53.22167139666,53.2155443540736,53.2176161219534,53.2164319648024,53.2204238319501,53.2215869360385,53.218526723402,53.2177978616399,53.2192111060978,53.2148649757222,53.2152999005499,53.2156357384904,53.2211696602,53.2152892775584,53.2145527039588,53.2143967503707,53.2187393824143,53.2220701365753,53.2188411298564,53.2166123156835,53.2211342582888,53.2219391989196,53.2223504595177,53.215218090883,53.2141563895887,53.2173954586479,53.2147219151774,53.2224017038569,53.2158201683047,53.2170968892164,53.2168804310761,53.2224986005841,53.2152187961767,53.2148455363806,53.2225761003961,53.2225462389901,53.2204333408742,53.2154068574911,53.2225348848186,53.2226176620847,53.2151956989775,53.2197879829053,53.2190618353494,53.2190486090455,53.2190307172422,53.2138149085314,53.2195576619144,53.2224259516829,53.2150898749316,53.2137991155113,53.2207501358322,53.219563139474,53.2137151100644,53.2138190307771,53.2149764232648,53.2180837672207,53.2229138813987,53.2178306006794,53.2229503752181,53.2229879449576,53.2149124828962,53.2171067478831,53.2170289696865,53.2170566376322],[6.56874841147005,6.56563034492428,6.56791119546557,6.56959542906929,6.56581688580706,6.56912879992328,6.5722257745779,6.56554155087897,6.57291138986805,6.56761183829811,6.56469067593046,6.56786543651903,6.5644324853776,6.56779089673334,6.57234979486227,6.57303869461157,6.56806995031835,6.56722258944165,6.57238760539811,6.57368201492079,6.57295581061705,6.57322018086482,6.57009850756302,6.57215000281837,6.57387537488373,6.56602190360323,6.56382335800716,6.57322875441805,6.57296435224638,6.5674282009664,6.5673773508574,6.56577542299857,6.56777642567897,6.56613099423001,6.57106334041015,6.56903405447653,6.56456084089018,6.5731137195653,6.56684281041853,6.57416455467469,6.56409124870617,6.5740320489289,6.57439606515953,6.57052439896184,6.57100289684666,6.5644672803039,6.56461684304987,6.56671664339561,6.56329012468512,6.57045925891402,6.56437357331895,6.57141958283825,6.56482029652979,6.56978989085716,6.57393827211977,6.57390431394439,6.57151101509391,6.56285520641188,6.57343604420821,6.5696123787756,6.57162895488318,6.56690545344321,6.5644460168265,6.56640206479719,6.5646896404414,6.5749913367414,6.56340262991514,6.56366138540319,6.56577800249164,6.57519102256682,6.57515940349729,6.57507975242389,6.57178378308375,6.56482388847762,6.56417931165256,6.56458364125831,6.56478004870399,6.57067495659759,6.56853241874381,6.56233133790551,6.57065797162274,6.57552325703156,6.57504374750122,6.57372367913826,6.57187982601073,6.56986117263208,6.56426499726943,6.56887385585258,6.56213779622595,6.57237858782712,6.56799194914215,6.5632534899044,6.56214847044168,6.56226348169167,6.56921630788513,6.56400346003002,6.56474177772425,6.5693128798888,6.56721928549392,6.57531265859465,6.57448750897306,6.5709331814821,6.56727692178208,6.56348956955932,6.57588789066213,6.57621273283885,6.57625246469965,6.57625879987486,6.56997803683013,6.56162300611469,6.57188204243475,6.56348959449191,6.57000577907661,6.56249499143799,6.56154905658301,6.56835112475971,6.56705492114196,6.56354076174848,6.56116223740797,6.56898708479061,6.56108438070039,6.56938849117961,6.56916248916267,6.56334940195631,6.57650882770049,6.56124056343689,6.57651265915784],{"icon":"ion-ios-home-outline","markerColor":"lightgray","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.2177373790044,53.2173285539375,53.2179300431445,53.2176394244576,53.2195572715696,53.2180119595637,53.2175184008692,53.2165996962098,53.219873415161,53.2173118987999,53.2171378942898,53.2166408418992,53.2166686130376,53.2166919572585],[6.56954269376849,6.56857358181483,6.56690733512168,6.56658360513712,6.5674885359709,6.57151078592449,6.566334378217,6.56927228963378,6.56744626199739,6.57145729146179,6.56600652721291,6.56672767905939,6.5714739980291,6.57154617099569],{"icon":"ion-ios-home-outline","markerColor":"orange","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[53.2137151100644,53.2229879449576],"lng":[6.56108438070039,6.57651265915784]}},"evals":[],"jsHooks":[]}</script>
<p>Pas Haversine formule alleen toe op adressen in het blok.</p>
<pre class="r"><code>data_binnen_cirkel &lt;- df %&gt;% filter(distance &lt; 200)
data_buiten_cirkel &lt;- setdiff(df, data_binnen_cirkel)

p5 &lt;- p1 %&gt;%
  addRectangles(
    lng1 = blok[3], lat1 = blok[1],
    lng2 = blok[4], lat2 = blok[2],
    fillColor = &quot;transparent&quot;
  ) %&gt;%
  addAwesomeMarkers(data = data_buiten_cirkel, ~lon, ~lat,  icon = icons_fn(&quot;ion-ios-home-outline&quot;, &quot;lightgray&quot;)) %&gt;%
  addAwesomeMarkers(data = data_binnen_cirkel, ~lon, ~lat,  icon = icons_fn(&quot;ion-ios-home-outline&quot;, &quot;orange&quot;), 
                                           popup = ~paste0(strong(&quot;Plaats: &quot;), city, br(), strong(&quot;Verzekerde som: &quot;), amount, &quot; euro&quot;,  
                                       br(), strong(&quot;Postcode: &quot;), postal_code, br(), strong(&quot;Huisnummer: &quot;), 
                                       number, br(), strong(&quot;Huisletter: &quot;), letter, br(), strong(&quot;Huisnrtoev: &quot;), 
                                       suffix, br(), strong(&quot;Straat: &quot;), street, br(), strong(&quot;Afstand: &quot;), 
                                       round(distance, 1), &quot; meter&quot;))
p5</code></pre>
<div id="htmlwidget-a7668e80bedcfcf77178" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-a7668e80bedcfcf77178">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Grote Markt 1, Groningen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRectangles","args":[53.2164833686837,6.56586445384021,53.2200766313163,6.57186554615979,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"transparent","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.219873415161,53.2173118987999,53.2163094013646,53.2171378942898,53.2166408418992,53.2191037678777,53.2161123576238,53.2166686130376,53.2204907305995,53.2166919572585,53.2196523878589,53.2159796911457,53.2195059973846,53.2195922682021,53.2176418791436,53.2207301840838,53.2190038710507,53.2157223578049,53.2182030663609,53.2156829310463,53.219954909918,53.2193866875824,53.2154859169103,53.2155817991444,53.2163128247022,53.2179336703458,53.2166910650464,53.2168936926272,53.2211525443666,53.2160421644618,53.2184511812159,53.215797206594,53.2183006213733,53.2167647248545,53.2164310039149,53.2153141747303,53.2153056256089,53.2157825088919,53.2213487692245,53.215557716607,53.2153634273226,53.2150670576958,53.2163038990505,53.2203039963528,53.221300950409,53.2174760909169,53.219886472525,53.2194378840393,53.2186210047531,53.2150942630355,53.2151674909867,53.2161662738447,53.2205405483542,53.2214588053398,53.2172971809997,53.2149229955026,53.2160380947013,53.2214322006943,53.2157242195534,53.2147803936376,53.2164546247836,53.2163945180733,53.2214663272668,53.2179927121175,53.2206414485976,53.2146806326981,53.2215104725557,53.2148448336952,53.2208483185609,53.22167139666,53.2155443540736,53.2176161219534,53.2164319648024,53.2204238319501,53.2215869360385,53.218526723402,53.2177978616399,53.2192111060978,53.2148649757222,53.2152999005499,53.2156357384904,53.2211696602,53.2152892775584,53.2145527039588,53.2143967503707,53.2187393824143,53.2220701365753,53.2188411298564,53.2166123156835,53.2211342582888,53.2219391989196,53.2223504595177,53.215218090883,53.2141563895887,53.2173954586479,53.2147219151774,53.2224017038569,53.2158201683047,53.2170968892164,53.2168804310761,53.2224986005841,53.2152187961767,53.2148455363806,53.2225761003961,53.2225462389901,53.2204333408742,53.2154068574911,53.2225348848186,53.2226176620847,53.2151956989775,53.2197879829053,53.2190618353494,53.2190486090455,53.2190307172422,53.2138149085314,53.2195576619144,53.2224259516829,53.2150898749316,53.2137991155113,53.2207501358322,53.219563139474,53.2137151100644,53.2138190307771,53.2149764232648,53.2180837672207,53.2229138813987,53.2178306006794,53.2229503752181,53.2229879449576,53.2149124828962,53.2171067478831,53.2170289696865,53.2170566376322],[6.56744626199739,6.57145729146179,6.56874841147005,6.56600652721291,6.56672767905939,6.56563034492428,6.56791119546557,6.5714739980291,6.56959542906929,6.57154617099569,6.56581688580706,6.56912879992328,6.5722257745779,6.56554155087897,6.57291138986805,6.56761183829811,6.56469067593046,6.56786543651903,6.5644324853776,6.56779089673334,6.57234979486227,6.57303869461157,6.56806995031835,6.56722258944165,6.57238760539811,6.57368201492079,6.57295581061705,6.57322018086482,6.57009850756302,6.57215000281837,6.57387537488373,6.56602190360323,6.56382335800716,6.57322875441805,6.57296435224638,6.5674282009664,6.5673773508574,6.56577542299857,6.56777642567897,6.56613099423001,6.57106334041015,6.56903405447653,6.56456084089018,6.5731137195653,6.56684281041853,6.57416455467469,6.56409124870617,6.5740320489289,6.57439606515953,6.57052439896184,6.57100289684666,6.5644672803039,6.56461684304987,6.56671664339561,6.56329012468512,6.57045925891402,6.56437357331895,6.57141958283825,6.56482029652979,6.56978989085716,6.57393827211977,6.57390431394439,6.57151101509391,6.56285520641188,6.57343604420821,6.5696123787756,6.57162895488318,6.56690545344321,6.5644460168265,6.56640206479719,6.5646896404414,6.5749913367414,6.56340262991514,6.56366138540319,6.56577800249164,6.57519102256682,6.57515940349729,6.57507975242389,6.57178378308375,6.56482388847762,6.56417931165256,6.56458364125831,6.56478004870399,6.57067495659759,6.56853241874381,6.56233133790551,6.57065797162274,6.57552325703156,6.57504374750122,6.57372367913826,6.57187982601073,6.56986117263208,6.56426499726943,6.56887385585258,6.56213779622595,6.57237858782712,6.56799194914215,6.5632534899044,6.56214847044168,6.56226348169167,6.56921630788513,6.56400346003002,6.56474177772425,6.5693128798888,6.56721928549392,6.57531265859465,6.57448750897306,6.5709331814821,6.56727692178208,6.56348956955932,6.57588789066213,6.57621273283885,6.57625246469965,6.57625879987486,6.56997803683013,6.56162300611469,6.57188204243475,6.56348959449191,6.57000577907661,6.56249499143799,6.56154905658301,6.56835112475971,6.56705492114196,6.56354076174848,6.56116223740797,6.56898708479061,6.56108438070039,6.56938849117961,6.56916248916267,6.56334940195631,6.57650882770049,6.56124056343689,6.57651265915784],{"icon":"ion-ios-home-outline","markerColor":"lightgray","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.2177373790044,53.2173285539375,53.2179300431445,53.2176394244576,53.2195572715696,53.2180119595637,53.2175184008692,53.2165996962098],[6.56954269376849,6.56857358181483,6.56690733512168,6.56658360513712,6.5674885359709,6.57151078592449,6.566334378217,6.56927228963378],{"icon":"ion-ios-home-outline","markerColor":"orange","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>20 euro<br/><strong>Postcode: <\/strong>9711NT<br/><strong>Huisnummer: <\/strong>20<br/><strong>Huisletter: <\/strong>a<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Oosterstraat<br/><strong>Afstand: <\/strong>75.4 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>30 euro<br/><strong>Postcode: <\/strong>9711ND<br/><strong>Huisnummer: <\/strong>30<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Gelkingestraat<br/><strong>Afstand: <\/strong>107.7 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>50 euro<br/><strong>Postcode: <\/strong>9711LX<br/><strong>Huisnummer: <\/strong>50<br/><strong>Huisletter: <\/strong>b<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Grote Markt<br/><strong>Afstand: <\/strong>136.2 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>6 euro<br/><strong>Postcode: <\/strong>9711KS<br/><strong>Huisnummer: <\/strong>6<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>1<br/><strong>Straat: <\/strong>Vismarkt<br/><strong>Afstand: <\/strong>168 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>24 euro<br/><strong>Postcode: <\/strong>9712GZ<br/><strong>Huisnummer: <\/strong>2<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Kwinkenplein<br/><strong>Afstand: <\/strong>169.2 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>68 euro<br/><strong>Postcode: <\/strong>9711PS<br/><strong>Huisnummer: <\/strong>68<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Achter de Muur<br/><strong>Afstand: <\/strong>178.9 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>12 euro<br/><strong>Postcode: <\/strong>9711KS<br/><strong>Huisnummer: <\/strong>12<br/><strong>Huisletter: <\/strong>a<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Vismarkt<br/><strong>Afstand: <\/strong>188.8 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>56 euro<br/><strong>Postcode: <\/strong>9711NE<br/><strong>Huisnummer: <\/strong>56<br/><strong>Huisletter: <\/strong>g<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Gelkingestraat<br/><strong>Afstand: <\/strong>189 meter"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[53.2137151100644,53.2229879449576],"lng":[6.56108438070039,6.57651265915784]}},"evals":[],"jsHooks":[]}</script>
<p>Pas Haversine formule alleen toe op adressen in het blok.</p>
<pre class="r"><code>p6 &lt;- p5 %&gt;%
  addCircles(lng = 6.568865, lat = 53.21828, stroke = FALSE,
    radius = 200, color = &quot;red&quot;, fillOpacity = .2
  )

p6</code></pre>
<div id="htmlwidget-7678319fe2ee1a445e76" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-7678319fe2ee1a445e76">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Grote Markt 1, Groningen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRectangles","args":[53.2164833686837,6.56586445384021,53.2200766313163,6.57186554615979,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"transparent","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.219873415161,53.2173118987999,53.2163094013646,53.2171378942898,53.2166408418992,53.2191037678777,53.2161123576238,53.2166686130376,53.2204907305995,53.2166919572585,53.2196523878589,53.2159796911457,53.2195059973846,53.2195922682021,53.2176418791436,53.2207301840838,53.2190038710507,53.2157223578049,53.2182030663609,53.2156829310463,53.219954909918,53.2193866875824,53.2154859169103,53.2155817991444,53.2163128247022,53.2179336703458,53.2166910650464,53.2168936926272,53.2211525443666,53.2160421644618,53.2184511812159,53.215797206594,53.2183006213733,53.2167647248545,53.2164310039149,53.2153141747303,53.2153056256089,53.2157825088919,53.2213487692245,53.215557716607,53.2153634273226,53.2150670576958,53.2163038990505,53.2203039963528,53.221300950409,53.2174760909169,53.219886472525,53.2194378840393,53.2186210047531,53.2150942630355,53.2151674909867,53.2161662738447,53.2205405483542,53.2214588053398,53.2172971809997,53.2149229955026,53.2160380947013,53.2214322006943,53.2157242195534,53.2147803936376,53.2164546247836,53.2163945180733,53.2214663272668,53.2179927121175,53.2206414485976,53.2146806326981,53.2215104725557,53.2148448336952,53.2208483185609,53.22167139666,53.2155443540736,53.2176161219534,53.2164319648024,53.2204238319501,53.2215869360385,53.218526723402,53.2177978616399,53.2192111060978,53.2148649757222,53.2152999005499,53.2156357384904,53.2211696602,53.2152892775584,53.2145527039588,53.2143967503707,53.2187393824143,53.2220701365753,53.2188411298564,53.2166123156835,53.2211342582888,53.2219391989196,53.2223504595177,53.215218090883,53.2141563895887,53.2173954586479,53.2147219151774,53.2224017038569,53.2158201683047,53.2170968892164,53.2168804310761,53.2224986005841,53.2152187961767,53.2148455363806,53.2225761003961,53.2225462389901,53.2204333408742,53.2154068574911,53.2225348848186,53.2226176620847,53.2151956989775,53.2197879829053,53.2190618353494,53.2190486090455,53.2190307172422,53.2138149085314,53.2195576619144,53.2224259516829,53.2150898749316,53.2137991155113,53.2207501358322,53.219563139474,53.2137151100644,53.2138190307771,53.2149764232648,53.2180837672207,53.2229138813987,53.2178306006794,53.2229503752181,53.2229879449576,53.2149124828962,53.2171067478831,53.2170289696865,53.2170566376322],[6.56744626199739,6.57145729146179,6.56874841147005,6.56600652721291,6.56672767905939,6.56563034492428,6.56791119546557,6.5714739980291,6.56959542906929,6.57154617099569,6.56581688580706,6.56912879992328,6.5722257745779,6.56554155087897,6.57291138986805,6.56761183829811,6.56469067593046,6.56786543651903,6.5644324853776,6.56779089673334,6.57234979486227,6.57303869461157,6.56806995031835,6.56722258944165,6.57238760539811,6.57368201492079,6.57295581061705,6.57322018086482,6.57009850756302,6.57215000281837,6.57387537488373,6.56602190360323,6.56382335800716,6.57322875441805,6.57296435224638,6.5674282009664,6.5673773508574,6.56577542299857,6.56777642567897,6.56613099423001,6.57106334041015,6.56903405447653,6.56456084089018,6.5731137195653,6.56684281041853,6.57416455467469,6.56409124870617,6.5740320489289,6.57439606515953,6.57052439896184,6.57100289684666,6.5644672803039,6.56461684304987,6.56671664339561,6.56329012468512,6.57045925891402,6.56437357331895,6.57141958283825,6.56482029652979,6.56978989085716,6.57393827211977,6.57390431394439,6.57151101509391,6.56285520641188,6.57343604420821,6.5696123787756,6.57162895488318,6.56690545344321,6.5644460168265,6.56640206479719,6.5646896404414,6.5749913367414,6.56340262991514,6.56366138540319,6.56577800249164,6.57519102256682,6.57515940349729,6.57507975242389,6.57178378308375,6.56482388847762,6.56417931165256,6.56458364125831,6.56478004870399,6.57067495659759,6.56853241874381,6.56233133790551,6.57065797162274,6.57552325703156,6.57504374750122,6.57372367913826,6.57187982601073,6.56986117263208,6.56426499726943,6.56887385585258,6.56213779622595,6.57237858782712,6.56799194914215,6.5632534899044,6.56214847044168,6.56226348169167,6.56921630788513,6.56400346003002,6.56474177772425,6.5693128798888,6.56721928549392,6.57531265859465,6.57448750897306,6.5709331814821,6.56727692178208,6.56348956955932,6.57588789066213,6.57621273283885,6.57625246469965,6.57625879987486,6.56997803683013,6.56162300611469,6.57188204243475,6.56348959449191,6.57000577907661,6.56249499143799,6.56154905658301,6.56835112475971,6.56705492114196,6.56354076174848,6.56116223740797,6.56898708479061,6.56108438070039,6.56938849117961,6.56916248916267,6.56334940195631,6.57650882770049,6.56124056343689,6.57651265915784],{"icon":"ion-ios-home-outline","markerColor":"lightgray","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.2177373790044,53.2173285539375,53.2179300431445,53.2176394244576,53.2195572715696,53.2180119595637,53.2175184008692,53.2165996962098],[6.56954269376849,6.56857358181483,6.56690733512168,6.56658360513712,6.5674885359709,6.57151078592449,6.566334378217,6.56927228963378],{"icon":"ion-ios-home-outline","markerColor":"orange","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>20 euro<br/><strong>Postcode: <\/strong>9711NT<br/><strong>Huisnummer: <\/strong>20<br/><strong>Huisletter: <\/strong>a<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Oosterstraat<br/><strong>Afstand: <\/strong>75.4 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>30 euro<br/><strong>Postcode: <\/strong>9711ND<br/><strong>Huisnummer: <\/strong>30<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Gelkingestraat<br/><strong>Afstand: <\/strong>107.7 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>50 euro<br/><strong>Postcode: <\/strong>9711LX<br/><strong>Huisnummer: <\/strong>50<br/><strong>Huisletter: <\/strong>b<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Grote Markt<br/><strong>Afstand: <\/strong>136.2 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>6 euro<br/><strong>Postcode: <\/strong>9711KS<br/><strong>Huisnummer: <\/strong>6<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>1<br/><strong>Straat: <\/strong>Vismarkt<br/><strong>Afstand: <\/strong>168 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>24 euro<br/><strong>Postcode: <\/strong>9712GZ<br/><strong>Huisnummer: <\/strong>2<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Kwinkenplein<br/><strong>Afstand: <\/strong>169.2 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>68 euro<br/><strong>Postcode: <\/strong>9711PS<br/><strong>Huisnummer: <\/strong>68<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Achter de Muur<br/><strong>Afstand: <\/strong>178.9 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>12 euro<br/><strong>Postcode: <\/strong>9711KS<br/><strong>Huisnummer: <\/strong>12<br/><strong>Huisletter: <\/strong>a<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Vismarkt<br/><strong>Afstand: <\/strong>188.8 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>56 euro<br/><strong>Postcode: <\/strong>9711NE<br/><strong>Huisnummer: <\/strong>56<br/><strong>Huisletter: <\/strong>g<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Gelkingestraat<br/><strong>Afstand: <\/strong>189 meter"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircles","args":[53.21828,6.568865,200,null,null,{"interactive":true,"className":"","stroke":false,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.2},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"limits":{"lat":[53.2137151100644,53.2229879449576],"lng":[6.56108438070039,6.57651265915784]}},"evals":[],"jsHooks":[]}</script>
<p>Sommeer de verzekerde sommen van de adressen in de cirkel.</p>
<pre class="r"><code>concentratie_som &lt;- sum(data_binnen_cirkel$amount)

p6 &lt;- p5 %&gt;%
  addCircles(lng = 6.568865, lat = 53.21828, stroke = FALSE,
    radius = 200, color = &quot;red&quot;, fillOpacity = .2) %&gt;%
    addAwesomeMarkers(lng = centrum[1], lat = centrum[2], icon = icons_fn(&quot;ion-ios-star&quot;, &quot;red&quot;), 
                      label = ~paste0(&quot;Concentration: &quot;, concentratie_som, &quot; Euro&quot;), 
                      labelOptions = labelOptions(noHide = T),
                      options = popupOptions(keepInView = TRUE))
p6</code></pre>
<div id="htmlwidget-341064dd3996919b7382" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-341064dd3996919b7382">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Grote Markt 1, Groningen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRectangles","args":[53.2164833686837,6.56586445384021,53.2200766313163,6.57186554615979,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"transparent","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.219873415161,53.2173118987999,53.2163094013646,53.2171378942898,53.2166408418992,53.2191037678777,53.2161123576238,53.2166686130376,53.2204907305995,53.2166919572585,53.2196523878589,53.2159796911457,53.2195059973846,53.2195922682021,53.2176418791436,53.2207301840838,53.2190038710507,53.2157223578049,53.2182030663609,53.2156829310463,53.219954909918,53.2193866875824,53.2154859169103,53.2155817991444,53.2163128247022,53.2179336703458,53.2166910650464,53.2168936926272,53.2211525443666,53.2160421644618,53.2184511812159,53.215797206594,53.2183006213733,53.2167647248545,53.2164310039149,53.2153141747303,53.2153056256089,53.2157825088919,53.2213487692245,53.215557716607,53.2153634273226,53.2150670576958,53.2163038990505,53.2203039963528,53.221300950409,53.2174760909169,53.219886472525,53.2194378840393,53.2186210047531,53.2150942630355,53.2151674909867,53.2161662738447,53.2205405483542,53.2214588053398,53.2172971809997,53.2149229955026,53.2160380947013,53.2214322006943,53.2157242195534,53.2147803936376,53.2164546247836,53.2163945180733,53.2214663272668,53.2179927121175,53.2206414485976,53.2146806326981,53.2215104725557,53.2148448336952,53.2208483185609,53.22167139666,53.2155443540736,53.2176161219534,53.2164319648024,53.2204238319501,53.2215869360385,53.218526723402,53.2177978616399,53.2192111060978,53.2148649757222,53.2152999005499,53.2156357384904,53.2211696602,53.2152892775584,53.2145527039588,53.2143967503707,53.2187393824143,53.2220701365753,53.2188411298564,53.2166123156835,53.2211342582888,53.2219391989196,53.2223504595177,53.215218090883,53.2141563895887,53.2173954586479,53.2147219151774,53.2224017038569,53.2158201683047,53.2170968892164,53.2168804310761,53.2224986005841,53.2152187961767,53.2148455363806,53.2225761003961,53.2225462389901,53.2204333408742,53.2154068574911,53.2225348848186,53.2226176620847,53.2151956989775,53.2197879829053,53.2190618353494,53.2190486090455,53.2190307172422,53.2138149085314,53.2195576619144,53.2224259516829,53.2150898749316,53.2137991155113,53.2207501358322,53.219563139474,53.2137151100644,53.2138190307771,53.2149764232648,53.2180837672207,53.2229138813987,53.2178306006794,53.2229503752181,53.2229879449576,53.2149124828962,53.2171067478831,53.2170289696865,53.2170566376322],[6.56744626199739,6.57145729146179,6.56874841147005,6.56600652721291,6.56672767905939,6.56563034492428,6.56791119546557,6.5714739980291,6.56959542906929,6.57154617099569,6.56581688580706,6.56912879992328,6.5722257745779,6.56554155087897,6.57291138986805,6.56761183829811,6.56469067593046,6.56786543651903,6.5644324853776,6.56779089673334,6.57234979486227,6.57303869461157,6.56806995031835,6.56722258944165,6.57238760539811,6.57368201492079,6.57295581061705,6.57322018086482,6.57009850756302,6.57215000281837,6.57387537488373,6.56602190360323,6.56382335800716,6.57322875441805,6.57296435224638,6.5674282009664,6.5673773508574,6.56577542299857,6.56777642567897,6.56613099423001,6.57106334041015,6.56903405447653,6.56456084089018,6.5731137195653,6.56684281041853,6.57416455467469,6.56409124870617,6.5740320489289,6.57439606515953,6.57052439896184,6.57100289684666,6.5644672803039,6.56461684304987,6.56671664339561,6.56329012468512,6.57045925891402,6.56437357331895,6.57141958283825,6.56482029652979,6.56978989085716,6.57393827211977,6.57390431394439,6.57151101509391,6.56285520641188,6.57343604420821,6.5696123787756,6.57162895488318,6.56690545344321,6.5644460168265,6.56640206479719,6.5646896404414,6.5749913367414,6.56340262991514,6.56366138540319,6.56577800249164,6.57519102256682,6.57515940349729,6.57507975242389,6.57178378308375,6.56482388847762,6.56417931165256,6.56458364125831,6.56478004870399,6.57067495659759,6.56853241874381,6.56233133790551,6.57065797162274,6.57552325703156,6.57504374750122,6.57372367913826,6.57187982601073,6.56986117263208,6.56426499726943,6.56887385585258,6.56213779622595,6.57237858782712,6.56799194914215,6.5632534899044,6.56214847044168,6.56226348169167,6.56921630788513,6.56400346003002,6.56474177772425,6.5693128798888,6.56721928549392,6.57531265859465,6.57448750897306,6.5709331814821,6.56727692178208,6.56348956955932,6.57588789066213,6.57621273283885,6.57625246469965,6.57625879987486,6.56997803683013,6.56162300611469,6.57188204243475,6.56348959449191,6.57000577907661,6.56249499143799,6.56154905658301,6.56835112475971,6.56705492114196,6.56354076174848,6.56116223740797,6.56898708479061,6.56108438070039,6.56938849117961,6.56916248916267,6.56334940195631,6.57650882770049,6.56124056343689,6.57651265915784],{"icon":"ion-ios-home-outline","markerColor":"lightgray","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[[53.2177373790044,53.2173285539375,53.2179300431445,53.2176394244576,53.2195572715696,53.2180119595637,53.2175184008692,53.2165996962098],[6.56954269376849,6.56857358181483,6.56690733512168,6.56658360513712,6.5674885359709,6.57151078592449,6.566334378217,6.56927228963378],{"icon":"ion-ios-home-outline","markerColor":"orange","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>20 euro<br/><strong>Postcode: <\/strong>9711NT<br/><strong>Huisnummer: <\/strong>20<br/><strong>Huisletter: <\/strong>a<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Oosterstraat<br/><strong>Afstand: <\/strong>75.4 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>30 euro<br/><strong>Postcode: <\/strong>9711ND<br/><strong>Huisnummer: <\/strong>30<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Gelkingestraat<br/><strong>Afstand: <\/strong>107.7 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>50 euro<br/><strong>Postcode: <\/strong>9711LX<br/><strong>Huisnummer: <\/strong>50<br/><strong>Huisletter: <\/strong>b<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Grote Markt<br/><strong>Afstand: <\/strong>136.2 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>6 euro<br/><strong>Postcode: <\/strong>9711KS<br/><strong>Huisnummer: <\/strong>6<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>1<br/><strong>Straat: <\/strong>Vismarkt<br/><strong>Afstand: <\/strong>168 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>24 euro<br/><strong>Postcode: <\/strong>9712GZ<br/><strong>Huisnummer: <\/strong>2<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Kwinkenplein<br/><strong>Afstand: <\/strong>169.2 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>68 euro<br/><strong>Postcode: <\/strong>9711PS<br/><strong>Huisnummer: <\/strong>68<br/><strong>Huisletter: <\/strong>NA<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Achter de Muur<br/><strong>Afstand: <\/strong>178.9 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>12 euro<br/><strong>Postcode: <\/strong>9711KS<br/><strong>Huisnummer: <\/strong>12<br/><strong>Huisletter: <\/strong>a<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Vismarkt<br/><strong>Afstand: <\/strong>188.8 meter","<strong>Plaats: <\/strong>Groningen<br/><strong>Verzekerde som: <\/strong>56 euro<br/><strong>Postcode: <\/strong>9711NE<br/><strong>Huisnummer: <\/strong>56<br/><strong>Huisletter: <\/strong>g<br/><strong>Huisnrtoev: <\/strong>NA<br/><strong>Straat: <\/strong>Gelkingestraat<br/><strong>Afstand: <\/strong>189 meter"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircles","args":[53.21828,6.568865,200,null,null,{"interactive":true,"className":"","stroke":false,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.2},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addAwesomeMarkers","args":[53.21828,6.568865,{"icon":"ion-ios-star","markerColor":"red","iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"maxWidth":300,"minWidth":50,"autoPan":true,"keepInView":true,"closeButton":true,"className":""},null,null,null,null,"Concentration: 266 Euro",{"interactive":false,"permanent":true,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[53.2137151100644,53.2229879449576],"lng":[6.56108438070039,6.57651265915784]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="samengevat" class="section level1">
<h1>Samengevat</h1>
<ol style="list-style-type: decimal">
<li>Maak een blok van 400 x 400 meter rond Grote Markt 1</li>
<li>Pas Haversine formule toe op de adressen in het blok</li>
<li>Sommeer verzekerde sommen van de adressen binnen een straal van 200m</li>
<li>Herhaal deze stappen voor alle circa 350.000 adressen in AAS-portefeuille</li>
</ol>
</div>
<div id="rshiny-concentration-risk-tool" class="section level1">
<h1>RShiny Concentration risk tool</h1>
<pre class="r"><code>shinyApp(

ui = navbarPage(&quot;Concentratierisicotool&quot;, id=&quot;nav&quot;, windowTitle = &quot;Concentratierisico&quot;, 

  tabPanel(&quot;Interactieve kaart op adres&quot;,
    div(class=&quot;outer&quot;,

      tags$head(
        includeCSS(&quot;css/styles2.css&quot;)
      ),

      leafletOutput(&quot;map&quot;, width=&quot;100%&quot;, height=&quot;100%&quot;),
    
      absolutePanel(id = &quot;controls&quot;, class = &quot;panel panel-default&quot;, fixed = TRUE,
        draggable = TRUE, top = 60, left = &quot;auto&quot;, right = 20, bottom = &quot;auto&quot;,
        width = 330, height = &quot;auto&quot;,
        br(),
        textInput(&quot;text1&quot;, label = &quot;Postcode (bijv. 9712HN):&quot;),
        textInput(&quot;text2&quot;, label = &quot;Huisnummer (bijv. 1):&quot;),
        textInput(&quot;text3&quot;, label = &quot;Huisletter:&quot;),
        textInput(&quot;text4&quot;, label = &quot;Huisnummertoevoeging:&quot;),
        hr(),
        p(&quot;De rode cirkel om het gekozen adres geeft een straal van 200 meter aan.&quot;),
        hr(),
        h5(textOutput(&quot;text9&quot;))
      )
    ))), 

server =  function(input, output, session){ ## Interactive Map ###########################################

  # Create the map
  output$map &lt;- renderLeaflet({
    postcode1 &lt;- toupper(gsub(&quot; &quot;, &quot;&quot;, input$text1)) 
    huisnummer0 &lt;- input$text2
    coords &lt;- spatialrisk::Groningen %&gt;% 
              filter(postal_code == postcode1) %&gt;% 
              select(lon, lat) %&gt;% 
              slice(1) %&gt;% 
              as.numeric(.)
    
    if (postcode1 %in% Groningen$postal_code) 
        leaflet() %&gt;%
          addTiles() %&gt;%
          setView(lng = coords[1], lat = coords[2], zoom = 16) 
    else{
        leaflet() %&gt;%
          addTiles() %&gt;%
          setView(lng = 5, lat = 52, zoom = 8)
      } 
    })
  
  
  observe({
    postcode1 &lt;- toupper(gsub(&quot; &quot;, &quot;&quot;, input$text1)) 
    huisnummer0 &lt;- input$text2
    coords &lt;- spatialrisk::Groningen %&gt;% 
              filter(postal_code == postcode1) %&gt;% 
              select(lon, lat) %&gt;% 
              slice(1) %&gt;% 
              as.numeric(.)
    
    block &lt;- spatialrisk::block_around_point(lon = coords[[1]], lat = coords[[2]])
    
    data &lt;- spatialrisk::Groningen %&gt;% sample_n(2000)
    
    data_sub &lt;- data[data$lon &gt; block[3] &amp;
                   data$lon &lt; block[4] &amp;
                   data$lat &gt; block[1] &amp;
                   data$lat &lt; block[2], ]
    
    uitkomst &lt;- sum(data_sub$amount, na.rm = TRUE)
    
    output$text9 &lt;- renderText({paste(&quot;De concentratie (straal 200 meter) op dit adres bedraagt:&quot;, uitkomst, &quot;euro.&quot;)}) 
    
    set.seed(2)
    df &lt;- Groningen %&gt;%
      sample_n(2000) #%&gt;%
      #points_in_circle(., coords[1], coords[2], radius = 330)
    
    leafletProxy(&quot;map&quot;) %&gt;% 
      clearShapes() %&gt;%
      addCircles(lng = coords[1], lat = coords[2], stroke = FALSE,
                 radius = 200, color = &quot;red&quot;, fillOpacity = .2) %&gt;%
      addAwesomeMarkers(data = df, lng = ~lon, lat = ~lat, icon = icons_fn(&quot;ion-ios-home-outline&quot;, &quot;orange&quot;), 
                         popup = ~paste0(strong(&quot;Plaats: &quot;), city, br(), strong(&quot;Verzekerde som: &quot;), amount, &quot; euro&quot;,  
                                       br(), strong(&quot;Postcode: &quot;), postal_code, br(), strong(&quot;Huisnummer: &quot;), 
                                       number, br(), strong(&quot;Huisletter: &quot;), letter, br(), strong(&quot;Huisnrtoev: &quot;), 
                                       suffix, br(), strong(&quot;Straat: &quot;), street)) %&gt;%
      addAwesomeMarkers(lng = coords[1], lat = coords[2], 
                        icon = icons_fn(&quot;ion-ios-star&quot;, &quot;red&quot;)) 
    })
}
)</code></pre>
<div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div>
</div>

</div> <!-- articleBandContent -->
</div> <!-- pageContent -->

<div id="rStudioFooter" class="band full">
<div class="bandContent">
  <div id="copyright">© Copyright 2017 RStudio inc.</div>
  <div id="logos">
    <a href="https://github.com/MHaringa" class="footerLogo gitHub"></a>
    <a href="https://www.linkedin.com/in/martin-haringa-71a7a61b" class="footerLogo linkedIn"></a>
  </div>
</div>
</div>

<!-- bizible -->
<script type="text/javascript" src="//cdn.bizible.com/scripts/bizible.js" async=""></script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
